# Recon Methodology

# Credits
- This wouldn't be possible without our lord and saviour [Jason Haddix](https://twitter.com/jhaddix)
- Huge thanks to [Cristi Zot](https://twitter.com/CristiVlad25) for giving me a head start at recon

# Table of content
- [Responsible Disclosure Programs](#responsible-disclosure-programs)
  - [Crowdsource Platforms](#crowdsource-platforms)
  - [VDP Google Dorks](#vdp-google-dorks)
- [Seed Domain Enumeration](#seed-domain-enumeration)
  - [Finding Acquisitions](#finding-acquisitions)
  - [ASN Enumeration](#asn-enumeration)
  - [Reverse WHOIS](#reverse-whois)
  - [Ad/Analytics Relationship Mapping](#adanalytics-relationship-mapping)
  - [Google Fu](#google-fu)
- [Subdomain enumeration](#subdomain-enumeration)
  - [Linked and JS Discovery](#linked-and-js-discovery)
    - [Manual Linked and JS Discovery](#manual-linked-and-js-discovery)
    - [Linked and JS Discovery Tools](#linked-and-js-discovery-tools)
    - [Linked and JS Discovery Oneliners](#linked-and-js-discovery-oneliners)
  - [Subdomain Scraping](#subdomain-scraping)
    - [Sources](#sources)
    - [Manual Subdomain Enumeration](#manual-subdomain-enumeration)
    - [Subdomain Enumeration Tools](#subdomain-enumeration-tools)
    - [Subdomain Enumeration Oneliners](#subdomain-enumeration-oneliners)
    - [Subdomain Enumeration Frameworks](#subdomain-enumeration-frameworks)
  - [Subdomain Bruteforce](#subdomain-bruteforce)
- [Content Discovery](#content-discovery)
  - [Wordlists](#wordlists)
  - [Fuzzers](#fuzzers)
- [Scanning](#scanning)
  - [Port Scanning](#port-scanning)
  - [Screenshotting](#screenshotting)
  - [Subdomain Takeover](#subdomain-takeover)
  - [Vulnerability Scanning](#vulnerability-scanning)
- [Sensitive Data Exposure](#sensitive-data-exposure)
  - [Google Dorking](#google-dorking)
  - [Github Recon](#github-recon)
  - [Shodan](#shodan-dorks)
  - [Bucket Hunting](#bucket-hunting)
  - [Hunting JS Files](#hunting-js-files)
  - [Digging into the Past](#digging-into-the-past)
- [Recon Frameworks](#recon-frameworks)
  - [C-Tier](#c-tier)
  - [B-Tier](#b-tier)
  - [A-Tier](#a-tier)
  - [S-Tier](#s-tier)

---

# Responsible Disclosure Programs

## Crowdsource Platforms

- [Github Security](https://bounty.github.com)
- [OpenBugBounty](https://www.openbugbounty.org)
- [HackerOne](https://hackerone.com)
- [Bugcrowd](https://bugcrowd.com)
- [Intigriti](https://www.intigriti.com/public)
- [Cobalt](http://cobalt.io)
- [Synack](http://synack.com)
- [ZeroCopter](https://zerocopter.com)
- [HackenProof](https://www.hackenproof.com)
- [Public bug bounty list](https://www.bugcrowd.com/bug-bounty-list)
- [Awesome bug bounty](https://github.com/djadmin/awesome-bug-bounty)
- [Google VRP](https://www.google.com/about/appsecurity/reward-program/)

## VDP Google Dorks

```
inurl:"responsible disclosure policy"
"powered by bugcrowd" -site:bugcrowd.com
"powered by hackerone"
"submit vulnerability report"
site:responsibledisclosure.com
inurl /bug bounty
inurl : / security
inurl:security.txt
inurl:security "reward"
inurl : /responsible disclosure
inurl : /responsible-disclosure/ reward
inurl : / responsible-disclosure/ swag
inurl : / responsible-disclosure/ bounty
inurl:'/responsible disclosure' hoodie
responsible disclosure swag r=h:com
responsible disclosure hall of fame
responsible disclosure europe
responsible disclosure white hat
white hat program
insite:"responsible disclosure" -inurl:nl
intext responsible disclosure
site eu responsible disclosure
site .nl responsible disclosure
site responsible disclosure
responsible disclosure:sites
responsible disclosure r=h:nl
responsible disclosure r=h:uk
responsible disclosure r=h:eu
responsible disclosure bounty r=h:nl
responsible disclosure bounty r=h:uk
responsible disclosure bounty r=h:eu
responsible disclosure swag r=h:nl
responsible disclosure swag r=h:uk
responsible disclosure swag r=h:eu
responsible disclosure reward r=h:nl
responsible disclosure reward r=h:uk
responsible disclosure reward r=h:eu
"powered by bugcrowd" -site:bugcrowd.com
"powered by hackerone" "submit vulnerability report"
"submit vulnerability report"
site:responsibledisclosure.com
inurl:'vulnerability-disclosure-policy' reward
intext:Vulnerability Disclosure site:nl
intext:Vulnerability Disclosure site:eu
site:*.*.nl intext:security report reward
site:*.*.nl intext:responsible disclosure reward
"security vulnerability" "report"
inurl"security report"
"responsible disclosure" university
inurl:/responsible-disclosure/ university
buy bitcoins "bug bounty"
inurl:/security ext:txt "contact"
"powered by synack"
intext:responsible disclosure bounty
inurl: private bugbountyprogram
inurl:/.well-known/security ext:txt
inurl:/.well-known/security ext:txt intext:hackerone
inurl:/.well-known/security ext:txt -hackerone -bugcrowd -synack -openbugbounty
inurl:reporting-security-issues
inurl:security-policy.txt ext:txt
site:*.*.* inurl:bug inurl:bounty
site:help.*.* inurl:bounty
site:support.*.* intext:security report reward
intext:security report monetary inurl:security 
intext:security report reward inurl:report
site:security.*.* inurl: bounty
site:*.*.de inurl:bug inurl:bounty
site:*.*.uk intext:security report reward
site:*.*.cn intext:security report reward
"vulnerability reporting policy"
"van de melding met een minimum van een" -site:responsibledisclosure.nl
inurl:/security ext:txt "contact"
"Submission Form powered by Bugcrowd" -bugcrowd.com
"If you believe you've found a security vulnerability"
intitle:"responsible disclosure policy"
```

---

# Seed Domain Enumeration

## Finding Acquisitions
- https://www.crunchbase.com/

## ASN Enumeration
- Manual enumeration via https://bgp.he.net/
- Discover seed domains - `amass intel --asn`
- Automated enumeration
  - ASNLookup (maxmind.com dataset)
  - metabigor (bgp.he.net, asnlookup.com) 

## Reverse WHOIS
- https://whoxy.com/
- DOMLink (CLI of whoxy.com)

## Ad/Analytics Relationship Mapping
- https://builtwith.com/
- *getrelationship.py* (CLI by M4ll0k)

```bash
echo "tesla.com" | python3 getrelationship.com
```

## Google Fu
- "Copyright Text" inurl:tesla.com
- "Terms of Service Text" inurl:tesla.com
- "Privacy Policy Text" inurl:tesla.com

# Subdomain Enumeration

## Linked and JS Discovery

### Manual Linked and JS Discovery

> Demonstrated using Burp Pro

- Set a scope item
  - Check "Use advanced scope controls"
  - Enter a term instead of an absolute domain name
  - Host or ip range: "keyword"
  - Site map
    - Filter by request type: Show only in-scope items
- Crawl all in-scope targets
  - Scan type: Crawl
  - Scan confgiruation
    - Crawl strategy - fastest
    - Never stop crawling due to application errors
  - Resource Pool
    - Name: "name"
    - Maximum concurrent requests: 50

### Linked and JS Discovery Tools

- Hakrawler
```bash
hakrawler -url tesla.com -hs -linkfinder
```

- GoSpirer
```bash
gospider -s https://tesla.com
```

- Subdomainizer
> Input JS files either from Burp or Hakrawler

```bash
python3 SubDomainizer.py -l jsfiles.txt -o js-subdomains.txt
```

- [Linkfinder](https://github.com/GerbenJavado/LinkFinder)
```bash
python linkfinder.py -i 'scripts/*.js' -r ^/api/ -o results.html
```

### Linked and JS Discovery Oneliners

- Pure bash linkfinder @ntrzz
```bash
curl -s $1 | grep -Eo "(http|https)://[a-zA-Z0-9./?=_-]*" | sort | uniq | grep ".js" > jslinks.txt; while IFS= read link; do python linkfinder.py -i "$link" -o cli; done < jslinks.txt | grep $2 | grep -v $3 | sort -n | uniq; rm -rf jslinks.txt
```

- Finding JS files script @D0cK3rG33k
```bash
assetfinder site.com | gau|egrep -v '(.css|.png|.jpeg|.jpg|.svg|.gif|.wolf)'|while read url; do vars=$(curl -s $url | grep -Eo "var [a-zA-Zo-9_]+" |sed -e 's, 'var','"$url"?',g' -e 's/ //g'|grep -v '.js'|sed 's/.*/&=xss/g'):echo -e "\e[1;33m$url\n" "\e[1;32m$vars";done
```

- Extract endpoints from JS files @renniepak
```bash
cat main.js | grep -oh "\"\/[a-zA-Z0-9_/?=&]*\"" | sed -e 's/^"//' -e 's/"$//' | sort -u
```

### Subscraper by Cillian Collins
- For recursive analysis

## Subdomain Scraping

### Sources
- Infrastructure sources
  - [Censys](https://censys.io/) (requires an api key)
  - Chaos (requires an api key)
  - Robtex (requires an api key)
  - DnsDB (requires an api key)
  - Github (requires an api key)
  - Passive Total (requires an api key)
  - NetCraft
  - PTRarchive
  - Wayback Machine

- Search sources
  - [BinaryEdge](https://binaryedge.io/)
  - [Shodan]() (requires an api key)
  - [Spyse]() (requires an api key)
  - Zoomeye (requires an api key)
  - Intelx (requires an api key)
  - Baidu
  - DogPile

- Security sources
  - VirusTotal
  - SecurityTrails (requires an api key)
  - F-Secure
  - Hacker Target
  - ThreatCrowd
  - ThreatMiner
  - ThreatBook (requires an api key)

- Certificate search
  - crt.sh
  - [CertSpotter](https://sslmate.com/certspotter/api/)
  - certDB

### Manual Subdomain Enumeration

- Google Subdomain Enumeration
```
site:tesla.com -www.tesla.com
site:tesla.com -www.tesla.com -test.tesla.com
site:tesla.com -www.tesla.com -test.tesla.com -staging.teala.com
site:tesla.com -www.tesla.com -test.tesla.com -staging.example.com -prod.tesla.com
```

### Subdomain Enumeration Tools

- [Amass](https://github.com/OWASP/Amass)
```bash
amass enum -d tesla.com
```

- [Subfinder](https://github.com/projectdiscovery/subfinder)
```bash
subfinder -d tesla.com
```

- [Findomain](https://github.com/Findomain/Findomain)
```bash
findomain -t tesla.com
```

- [AssetFinder](https://github.com/tomnomnom/assetfinder)
```bash
assetfinder --subs-only tesla.com
```

- [shosubgo](https://github.com/tokyodevs/shosubgo)
```bash
go run main.go -d target.com -s YourAPIKEY
```

### Subdomain Enumeration Oneliners

- Get subdomains from rapiddns.io 
> @andirrahmani1
```bash
curl -s "https://rapiddns.io/subdomain/$1?full=1#result" | grep "<td><a" | cut -d '"' -f 2 | grep http | cut -d '/' -f3 | sed 's/#results//g' | sort -u
```

- Get subdomains from bufferover.run 
> @\_ayoubfathi\_
```bash
curl -s https://dns.bufferover.run/dns?q=.DOMAIN.com |jq -r .FDNS_A[]|cut -d',' -f2|sort -u
```

- Get subdomains from riddler.io
> @pikpikcu
```bash
curl -s "https://riddler.io/search/exportcsv?q=pld:domain.com" | grep -Po "(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | sort -u
```

- Get subdomains from virustotal
> @pikpikcu
```bash
curl -s "https://www.virustotal.com/ui/domains/domain.com/subdomains?limit=40" | grep -Po "((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | sort -u
```

- Get Subdomains from CertSpotter
> @pikpikcu
```bash
curl -s "https://certspotter.com/api/v0/certs?domain=domain.com" | grep -Po "((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | sort -u
```

- Get Subdomains from Archive
> @pikpikcu
```bash
curl -s "http://web.archive.org/cdx/search/cdx?url=*.domain.com/*&output=text&fl=original&collapse=urlkey" | sed -e 's_https*://__' -e "s/\/.*//" | sort -u
```

- Get Subdomains from JLDC
> @pikpikcu
```bash
curl -s "https://jldc.me/anubis/subdomains/domain.com" | grep -Po "((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | sort -u
```

- Get Subdomains from securitytrails
> @pikpikcu
```bash
curl -s "https://securitytrails.com/list/apex_domain/domain.com" | grep -Po "((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | grep ".domain.com" | sort -u
```

- Get Subdomains from crt.sh
> @vict0ni
```bash
curl -s "https://crt.sh/?q=%25.$1&output=json" | jq -r '.[].name_value' | sed 's/\*\.//g' | sort -u
```

### Subdomain Enumeration Frameworks

- LazyRecon
```
./lazyrecon.sh -d tesla.com
./lazyrecon.sh -d tesla.com -e excluded.tesla.com,other.tesla.com
```

## Subdomain Bruteforce

- [Amass](https://github.com/OWASP/Amass)
```bash
amass enum -brute -d tesla.com -src
amass enum -brute -d tesla.com -rf resolvers.txt -w wordlist.txt
```

- [Subbrute](https://github.com/TheRook/subbrute)
```bash
./subbrute.py tesla.com
```

- [Aiodnsbrute](https://github.com/blark/aiodnsbrute)
```bash
aiodnsbrute -w wordlist.txt -vv -t 1024 tesla.com
aiodnbrute -f - -o json tesla.com
aiodnsbrute -r resolvers.txt -f - -o json tesla.com | jq '.[] | select(.ip[] | startswith("172."))'
aiodnsbrute --gethostbyname domain.com
aiodnsbrute -r resolvers.txt domain.com
```

- [massDNS](https://github.com/blechschmidt/massdns)
```bash
./bin/massdns -r lists/resolvers.txt -t AAAA -w results.txt domains.txt
```

- [shuffleDNS](https://github.com/projectdiscovery/shuffledns)
```bash
shuffledns -d tesla.com -list wordlist.txt -r resolvers.txt
subfinder -d tesla.com | shuffledns -d tesla.com -r resolvers.txt
```

- Subdomain Wordlist by Jason Haddix
https://gist.github.com/jhaddix/86a06c5dc309d08580a018c66354a056

# Content Discovery

## Wordlists
- [fuzzdb](https://github.com/fuzzdb-project/fuzzdb)
- [minimaxir](https://github.com/minimaxir/big-list-of-naughty-strings)
- [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)
- [SecLists](https://github.com/danielmiessler/SecLists)
- [IntruderPayloads](https://github.com/1N3/IntruderPayloads)
- [bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [PassList](https://github.com/j3ers3/PassList)
- [jeanphorn](https://github.com/jeanphorn/wordlist)
- [lavalamp](https://github.com/lavalamp-/password-lists)
- [assetnote](https://wordlists.assetnote.io/)

## Fuzzers
- [ffuf](https://github.com/ffuf/ffuf)
- [wfuzz](https://github.com/xmendez/wfuzz)
- [dotdotpwn](https://github.com/wireghoul/dotdotpwn)
- [Arjun](https://github.com/s0md3v/Arjun)
- [dirsearch](https://github.com/maurosoria/dirsearch)
- [gobuster](https://github.com/OJ/gobuster)

---

# Scanning

## Port Scanning

- Masscan
```bash
masscan -p1-65535 192.168.0.1 --max-rate 1800 -oG output.log
masscan -p1-65535 -iL ips.txt --max-rate 1800 -oG output.log
```

- DNMasscan
```bash
dnmasscan example.txt dns.log -p80,443 -oG masscan.log
```

- Masscan to Service Scan to Credential Bruteforce
  1. dnmasscan - port scanning
  2. nmap - service scan -oG
  3. brutespray - credential bruteforce

## Screenshotting

- [EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness)
```bash
python3 EyeWitness.py -f /path/to/live-domains.txt -d /path/to/eyewitness/ --web
```

- [Aquatone](https://github.com/michenriksen/aquatone)
```bash
cat targets.txt | aquatone
```

- [httpscreenshot](https://github.com/breenmachine/httpscreenshot)
```bash
./httpscreenshot.py -i \<gnmapFile\> -p -w 5 -a -vH
```

## Subdomain Takeover

- [Can I takeover XYZ?](https://github.com/EdOverflow/can-i-take-over-xyz)

- SubOver
```bash
./subover -l /path/to/live-domains.txt -v
```

- Nuclei
```bash
nuclei -l /path/to/live-domains.txt -t subdomain-takeover/*
```

## Vulnerability Scanning

- [Nuclei](https://github.com/projectdiscovery/nuclei)
- [Nuclei Templates](https://github.com/projectdiscovery/nuclei-templates)
- [Nikto](https://github.com/sullo/nikto)
- [Gofingerprint](https://github.com/Static-Flow/gofingerprint)
- [Sn1per](https://github.com/1N3/Sn1per)

# Sensitive Data Exposure

## Google Dorking
- Google Hacking Database
- [Dorks by Faisal Ahmed](https://dorks.faisalahmed.me)

## Github Recon

- [Github Search](https://github.com/gwen001/github-search)
- [GitDorker](https://github.com/obheda12/GitDorker)
- [GitLeaks](https://github.com/zricethezav/gitleaks)
- [KeyHacks](https://github.com/streaak/keyhacks)
- [Github Dorks](https://github.com/H4CK3RT3CH/github-dorks)
- [Gitrob](https://github.com/michenriksen/gitrob)
- [TruffleHog](https://github.com/dxa4481/truffleHog)
- [GittyLeaks](https://github.com/kootenpv/gittyleaks)

## Shodan

- [Shodan Guide](https://danielmiessler.com/study/shodan/)

- [Shodan Book](https://leanpub.com/shodan)

- [Shodan Python Scripts](https://gist.github.com/yehgdotnet/b9dfc618108d2f05845c4d8e28c5fc6a)

- [Weaponizing favicon.ico for BugBounties , OSINT and what not](https://medium.com/@Asm0d3us/weaponizing-favicon-ico-for-bugbounties-osint-and-what-not-ace3c214e139)

- Favicon analysis / Favfreak

```bash
cat urls.txt | python3 favfreak.py -o output
```

- Favicon analysis / Shodan

```bash
shodan search org:"Target" http.favicon.hash:<hash> --fields ip str,port --separator " " | awk '{print $1":"$2}'
```

- Shodan Dorks / from @manas_hunter

```
"default password" org:teslamotors
"230 login successful" port:"21" org:teslamotors
vsftpd 2.3.4 port:21 org:teslamotors
230 "anonymous@" login ok org:teslamotors
guest login ok org:teslamotors
country:EU port:21 -530 +230 +teslamotors
country:IN port:80 title:protected org:teslamotors
```

## Bucket Hunting

- [S3Scanner](https://github.com/sa7mon/S3Scanner)
- [S3Inspector](https://github.com/clario-tech/s3-inspector)
- [BucketFlaws](https://github.com/nikhil1232/bucket-flaws)
- [GrayhatWarfare](https://buckets.grayhatwarfare.com/)
- [Slurp](https://github.com/0xbharath/slurp)
- [AwsBucketDump](https://github.com/jordanpotti/awsbucketdump)

## Hunting JS Files

- [SecretFinder](https://github.com/m4ll0k/SecretFinder)
- [ScriptHunter](https://github.com/robre/scripthunter)
- [LinkFinder](https://github.com/GerbenJavado/LinkFinder)
- [JS Beautifier](https://chrome.google.com/webstore/detail/javascript-and-css-code-b/iiglodndmmefofehaibmaignglbpdald?hl=en)
- Keywords

```
api
key
http
https
api_key
apikey
token
secret
config
conf
cfg
ENV
env
```

## Digging into the Past

- [The Wayback Machine](https://archive.org/)
- [WaybackUrls](https://github.com/tomnomnom/waybackurls)

```bash
echo "twitter.com" | waybackurls > wayback-results

cat wayback-results | grep "\.conf"
cat wayback-results | grep "\.xml"
cat wayback-results | grep "\.db"
cat wayback-results | grep "\.log"
cat wayback-results | grep "config"
cat wayback-results | grep "env"
cat wayback-results | grep "key"
cat wayback-results | grep "token"
cat wayback-results | grep "panel"
cat wayback-results | grep "dashboard"
```

---

# Recon Frameworks

## C-Tier
> Automation built around scripting up other tools in bash or python. Step based, no workflow. Few techniques. Little extensibility.

- https://github.com/AdmiralGaust/bountyRecon
- https://github.com/offhourscoding/recon
- https://github.com/Sambal0x/Recon-tools
- https://github.com/JoshuaMart/AutoRecon
- https://github.com/yourbuddy25/Hunter
- https://github.com/venom26/recon/blob/master/ultimate_recon.sh
- https://gist.github.com/dwisiswant0/5f647e3d406b5e984e6d69d3538968cd
   
## B-Tier
> Automation writing a few of their own modules. Some GUI or advanced workflow. Medium techniques. Runs point-in-time. Flat files.

- https://github.com/capt-meelo/LazyRecon
- https://github.com/Screetsec/Sudomy
- https://github.com/phspade/Automated-Scanner
- https://github.com/shmilylty/OneForAll
- https://github.com/LordNeoStark/tugarecon
- https://github.com/SolomonSklash/chomp-scan
- https://github.com/TypeError/domained
- https://github.com/phspade/Automated-Scanner

## A-Tier
> Automation writing all their own modules. Has GUI. Runs iterativley. Manages data via db.

- https://github.com/Edu4rdSHL/findomain
- https://github.com/SilverPoision/Rock-ON
- https://github.com/epi052/recon-pipeline

## S-Tier
> Automation writing their own modules. Has GUI. Runs iterativley. Manages data via db. Scales across multiple boxes. Sends alerts to user. Uses novel techniques and iterates quickly. ML + AI.

- [Intrigue](https://intrigue.io/)
- [AssetNote](https://assetnote.io/)
- [Spiderfoot](https://www.spiderfoot.net/)
- [Project Discovery](https://projectdiscovery.io/)
- [reNgine](https://github.com/yogeshojha/rengine)
- [Recon-ng](https://github.com/lanmaster53/recon-ng)
